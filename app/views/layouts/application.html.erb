<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <!-- iOS metatag -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <title><%= content_for?(:title) ? yield(:title) : "Kokkonut" %></title>
    <%= csrf_meta_tags %>
    
    <!-- Stylesheet -->
    <%= stylesheet_link_tag "application" %>
    <!-- Javascript -->
    <%= javascript_include_tag "application" %>

    <!-- Favicon and apple-touch-icon -->
    <%= favicon_link_tag 'icon/favicon.ico', :rel => 'shortcut icon' %>
    <%= favicon_link_tag 'icon/apple-touch-icon.png', :rel => 'apple-touch-icon', :type => 'image/png' %>
    <%= favicon_link_tag 'icon/apple-touch-icon-72x72.png', :rel => 'apple-touch-icon', :type => 'image/png', :sizes => '72x72' %>
    <%= favicon_link_tag 'icon/apple-touch-icon-144x144.png', :rel => 'apple-touch-icon', :type => 'image/png', :sizes => '144x144' %>
  
    <!-- Google Web Fonts-->
    <link href="http://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Alfa+Slab+One" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Sintony" rel="stylesheet" type="text/css">

    <!-- Calendar style and js -->
    <%= csrf_meta_tag %>
    <link rel='stylesheet' type='text/css' href='http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/themes/start/jquery-ui.css' />
    <script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js'></script>
    <script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js'></script>
    <%= stylesheet_link_tag "weekcalendar" %>
    <%= stylesheet_link_tag "application" %>
    <%= stylesheet_link_tag "demo" %>
    <%= stylesheet_link_tag "reset" %>
    <%= javascript_include_tag "jquery.weekcalendar" %>
    <% if current_user.role.include? "admin" %>
    <%= javascript_include_tag "demo" %>
    <% else %>
    <%= javascript_include_tag "demoUser" %>
    <% end %>
  </head>

  <body >
    <% if current_user %>
    
      <div class="row-fluid" id="profile-row-line-top">
        <div class="span12" id="light-menu">
          <ul type="none"> 
            <%= link_to controller: :messages, action: :show do %>
            <li id="msg_notification"><i class="icon icon-envelope"></i>
             <% if current_user_message_count > 0 %>
             &nbsp;&nbsp;<%= current_user_message_count %>
             <% end %>
           </li>
           <% end %>
           <li><%= link_to '<i class="icon-user"></i>&nbsp;'.html_safe+current_user.username.capitalize, :controller => :users, :action => :home_utente %>
             <% if current_user.first_name && !current_user.first_name.blank? %>
             (<%=current_user.first_name%>)
             <% end %>
           </li>
           <li><a href="#settings-modal" data-toggle="modal"><i class="icon-cogs"></i>&nbsp;Impostazioni</li></a></li>
           <li><%= link_to '<i class="icon-off"></i>&nbsp;Logout'.html_safe, controller: :sessions, action: :destroy %></li>
         </ul>
         <ul type="none" style="float: left">
          <% if current_user.role == "user" && ( controller.controller_name == 'programs' ||  controller.controller_name == 'lessons' ) %>
          <li> <%= @program.title %> </li>
          <% end %>
         </ul>
       </div>
     </div>
     <% else %>
     <div class="row-fluid" id="row-line-top">
      <div class="span12" id="light-menu">
        <ul type="none">
          <li><%= link_to '<i class="icon-group"></i>&nbsp;chi siamo'.html_safe, controller: :welcome, action: :whoweare %></li> 
          <li><a href="mailto:dea.dormi@gmail.com"><i class="icon-envelope"></i>&nbsp;contatti</a></li>
        </ul> 
      </div>
    </div>
    <% end %>
    <!--<%= bootstrap_flash %>-->
    <%= yield %>
  
  </body>
</html>

<% if current_user %>
<!--Settings modal-->
<div id="settings-modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel" style="color:white">Impostazioni <%= current_user.username.capitalize %></h3>
  </div>
  <div class="modal-body center">
    <%= form_for :edited_user,url: { controller: :users, action: :update} do |f| %>
    <%= f.text_field :first_name, :value => current_user.first_name, placeholder: "Nome" %><br /><br />
    <%= f.text_field :second_name, :value => current_user.second_name, placeholder: "Cognome" %><br /><br />
    <%= f.text_field :where, :value => current_user.where, placeholder: "Città" %><br /><br />
    <%= f.password_field :new_password, placeholder: "Nuova Password", :value => "password" %><br /><br />
    <%= f.password_field :new_password_confirm, placeholder: "Conferma Password", :value => "passward" %>
    </div>
  <div class="modal-footer">
    <button class="btn btn-large" data-dismiss="modal" aria-hidden="true"><i class="icon-reply"></i>&nbsp;&nbsp;Indietro</button>
    <button type="submit" class="btn btn-primary btn-large" id="edit"%><i class="icon-check"></i>&nbsp;&nbsp;Salva Cambiamenti</button>
    
    <% end %>
  </div>
</div>
<!--Settings modal-->
<% end %>
